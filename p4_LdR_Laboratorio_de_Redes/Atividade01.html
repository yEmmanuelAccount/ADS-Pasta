<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/00-home.css">
    <title>Passo a passo da Atividade 01</title>
</head>
<body class="ldr-page">
    <header>
        <a href="./" class="btn-voltar">Voltar</a>
    </header>

    <div class="conteudo">
        <h1>Como fazer a Atividade 01</h1>

        <h2>Video</h2>
            <iframe 
                width="560" height="315"
                src="https://youtu.be/qCjXMhIiTUI" 
                frameborder="0">
            </iframe>

            <ul>
                <li>Tempo Assistido: 00:06:23</li>
                <li>Tempo Total: 01:33:15</li>
                <li>Porcentagem: 6,85%</li>
            </ul>

        <h2>Informações Importantes</h2>
            <ol>
                <li>VMs Docker (CLIENTE) - Servidor XEN: <a href="http://177.12.113.61:9090">http://177.12.113.61:9090</a></li>
                <li>Ubuntu22s (SERVIDOR) - ESXi: <a href="http://177.12.113.61:9001">http://177.12.113.61:9001</a></li>
            </ol>

        <h1>Montando Rede - Preparando Cenário</h1>

        <h2>Entrando no Servidor XEN</h2>
            <p>Login</p>
            <ul>
                <li>Username: ads2</li>
                <li>Password: @ds654123</li>
            </ul>

            <p>Ao entrar, primeiramente é mostrado as VMs que estão em <em>running</em>. Se o filtro for trocado para <strong>None</strong>, serão mostradas todas as VMs as quais esse usuário tem acesso.</p>

            <p>As VMs que apresentagem o símbolo de <strong>círculo vermelho</strong> antes de seus nomes estão <strong>desligadas</strong>. Para ligá-las, basta clicar no círculo vermelho ou no botão de <em>Start</em> localizado do lado esquerdo do nome do sistema operacional da VM.</p>

            <p>Depois que a VM estiver devidamente iniciada, clique em seu nome (exemplo: Docker_clone24) e procure a opção <strong>Console</strong>.</p>

        <h2>Docker_clone24</h2>
            <p>Login</p>
            <ul>
                <li><code>dut login</code>: djr</li>
                <li><code>Password</code>: 654123</li>
            </ul>

            <p>Logo após o login, observe o IP da sua VM e anote. Outra forma de obtê-lo posteriormente é usando o comando <code>ifconfig</code>.</p>
            <pre><code>
                IP address for eth0: 192.168.1.61
            </code></pre>

            <p>Em seguida, vamos nos transformar em <strong>SuperUsuário</strong> e iniciar a interface gráfica.</p>
            <pre><code>
                djr@dut:~$ sudo su 
                [sudo] password for djr: 654123
                
                startx
            </code></pre>

        <h2>Login no ESXi</h2>
            <p>Login</p>
            <ul>
                <li>User name: ads24</li>
                <li>Password: @ds654123</li>
            </ul>

            <p>Já logado, clique em <strong>Virtual Machines</strong> no menu esquerdo e pesquise o nome da VM ligada no tópico anterior (exemplo: clone24). É dito que a que deve ser aberta é a <strong>Ubuntu22s-clone24</strong> referente ao semestre de 2022, então a nossa deve ser <strong>Ubuntu26s</strong>, mas não tenho certeza disso.</p>

            <p>Estando dentro da máquina certa, procure o botão <strong>Power on</strong> localizado no menu superior. Clique na imagem que antes era o Pinguim para abrir o terminal.</p>

            <p>Login</p>
            <ul>
                <li>ubuntu22server login: ads</li>
                <li>Password: 654123</li>
            </ul>

            <p>Após o login, é possível observar o IP que essa máquina possui:</p>
            <pre><code>
                IPv4 address for ens160: 192.168.1.94
            </code></pre>

            <p>Para ter certeza que é esse mesmo o IP, se transforme em SuperUsuário, siga os comandos a seguir e procure o IP referente a Interface <code>ens160</code>:</p>
            <pre><code>
                ads@ubuntu22server:$ sudo su 
                [sudo] password for ads: 654123

                ip a <comment># equivalente ao ifconfig</comment>
            </code></pre>

            <h3>Caso não existe IP</h3>
                <pre><code>
                    dhclient ens160

                    ip a
                </code></pre>

                <p>Procure o IP referente a Interface <strong>ens160</strong>, em frente a <strong>inet</strong>. Exemplo: 192.168.1.78</p>

        <h2>Docker-clone24</h2>
            <p>Aperte no botão <strong>Iniciar</strong>, o primeiro do lado esquerdo da barra de tarefas, depois em <strong>Acessórios</strong> e por último em <strong>LXTerminal</strong> para abrir o terminal da Docker-clone24.</p>

            <p>Dentro do terminal, aperte <code>Ctrl + Shift + T</code> duas vezes, para abrir mais duas abas. Estando na primeira, clique em <strong>Aba</strong> e depois em <strong>Nome da aba</strong> e a renomei para HOST_LOCAL. Faça o mesmo processo com as demais e as renomei para ESXI_HOST e ESXI_DOCKER_HTTPS.</p>

            <div class="box">
                <tabs>
                    <tab>HOST_LOCAL</tab>
                    <tab class="selected">ESXI_HOST</tab>
                    <tab>ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    ssh ads@192.168.1.78 <comment># IP da máquina da ESXI</comment>

                    yes <comment># para confirmar a conexão</comment>

                    ads@192.168.1.78's password: 654123
                </code></pre>
            </div>

            <p>A função dessa tela é servir como espaço para que os algoritmos de controle de congestionamento sejam trocados.</p>

            <div class="box">
                <tabs>
                    <tab>HOST_LOCAL</tab>
                    <tab class="selected">ESXI_HOST</tab>
                    <tab>ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    ads@ubuntu22server:~$ sudo su 
                    [sudo] password for ads: 654123 
                </code></pre>
            </div>

            <p>"Lembrando que o algoritmo de controle de congestionamento de TCP de todo mundo que inicializa o Linux é o cubic. Só para mostrar:</p>
            <div class="box">
                <tabs>
                    <tab>HOST_LOCAL</tab>
                    <tab class="selected">ESXI_HOST</tab>
                    <tab>ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    root@ubuntu22server:/home/ads# cat /proc/sys/net/ipv4/tcp_congestion_control
                </code></pre>
            </div>

            <p>O algoritmo de controle de congestionamento só será trocado no Servidor SXI</p>

            <div class="box">
                <tabs>
                    <tab>HOST_LOCAL</tab>
                    <tab>ESXI_HOST</tab>
                    <tab class="selected">ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    root@dut:/home/djr# ssh ads@192.168.1.78
                    ads@192.168.1.78's password: 654123
                </code></pre>
            </div>

            <p>Uma forma de observar que está realmente conectada é ver o <strong>IPv4 address for ens160: 192.168.1.78</strong>.</p>

            <div class="box">
                <tabs>
                    <tab>HOST_LOCAL</tab>
                    <tab>ESXI_HOST</tab>
                    <tab class="selected">ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    ads@ubuntu22server:~$ sudo su
                    [sudo] password for ads: 654123

                    <comment># inicializando container</comment>
                    root@ubuntu22server:/home/ads# docker start 64
                    root@ubuntu22server:/home/ads# docker attach 64

                    root@ubuntu22server:/home/ads# service apache2 start
                </code></pre>
            </div>

            <div class="box">
                <tabs>
                    <tab class="selected">HOST_LOCAL</tab>
                    <tab>ESXI_HOST</tab>
                    <tab>ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    root@dut:/home/djr# ping 172.17.0.2 <comment># ainda impossível de alcançar</comment>

                    <comment># digite 'Ctrl + C' para parar o processo</comment>

                    root@dut:/home/djr# route add -net 172.17.0.0 netmask 255.255.0.0 gw 192.168.1.78 <comment># IP ao qual está conectado das outras 2 abas</comment>

                    <comment># testando novamente o comando de ping</comment>
                    root@dut:/home/djr# ping 172.17.0.2
                </code></pre>
            </div>

            <p>Nesse ponto, a rede está montada. Agora podemos começar os experimentos.</p>

        <h1>Iniciando Experimentos</h1>
            <p>Criando diretórios:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">HOST_LOCAL</tab>
                    <tab>ESXI_HOST</tab>
                    <tab>ESXI_DOCKER_HTTPS</tab>
                </tabs>
                <pre><code> 
                    root@dut:/home/djr/# mkdir atividade1
                    root@dut:/home/djr/# cd atividade1/
                    root@dut:/home/djr/atividade1# mkdir apache2 nginx
                    root@dut:/home/djr/atividade1# cd apache2/ 
                    root@dut:/home/djr/atividade1/apache2# mkdir cubic bic yeah westwood veno
                    root@dut:/home/djr/atividade1/apache2# cd ..
                    root@dut:/home/djr/atividade1/# cd nginx/
                    root@dut:/home/djr/atividade1/nginx# mkdir cubic bic yeah westwood veno

                    <comment># para verificar se os mesmos estão criados nos 2</comment>
                    root@dut:/home/djr/atividade1/nginx# ls
                    root@dut:/home/djr/atividade1/nginx# cd ../apache2/;ls

                    <comment># primeira medição</comment>
                    root@dut:/home/djr/atividade1/apache2# cd cubic/
                    root@dut:/home/djr/atividade1/apache2/cubic# ab -n 2000 -c 200 -e apache2_cubic.csv https://172.17.0.2/ > apache2_cubic.txt

                    root@dut:/home/djr/atividade1/apache2/cubic# ls <comment># para verificar a existência dos arquivos .csv e .txt</comment>
                </code></pre>
            </div>
    </div>
</body>
</html>