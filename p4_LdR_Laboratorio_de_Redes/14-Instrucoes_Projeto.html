<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/00-home.css">
    <title>Tutorial para o Script da Atividade1</title>
</head>
<body class="ldr-page">
    <header>
        <a href="./" class="btn-voltar">Voltar</a>
    </header>

    <div class="conteudo">
        <h1>Script da Atividade1</h1>

        <h2>Sumário</h2>
            <nav class="sumario">
                <ul>
                    <li><a href="#informacoes_importantes">Informações Importantes</a></li>
                        <p>Tópicos importantes para o andamento do documento.</p>
                    <li><a href="#ip_proxmox">IP do Proxmox</a></li>
                        <p>Mostra como obter o IP do Proxmox.</p>
                    <li><a href="#permissoes">Modificando Permissões</a></li>
                        <p>Entra no arquivo de <strong>sshd_config</strong> e troca a permissão de login na root para verdadeira.</p>
                    <li><a href="#script">Script</a></li>
                        <p>Como rodar o script propriamente dito.</p>
                    <li><a href="#tirando_arquivos">Tirando Arquivos da VM</a></li>
                        <p>Solução para tirar os arquivos resultantes do script de dentro da VM para sua máquina.</p>
                    <li><a href="#enviando_arquivos">Como Enviar os Arquivos da Atividade</a></li>
                        <p>Forma de enviar os arquivos sem quebrá-los ou tirar sua formatação.</p>
                </ul>
            </nav>

        <h2 id="informacoes_importantes">Informações Importantes</h2>
            <ol>
                <li>VMs Docker (CLIENTE) - Servidor XEN: <a href="https://200.129.71.165/">https://200.129.71.165/</a></li>
                <li>Ubuntu22s (SERVIDOR) - ESXi: <a href="https://200.129.71.165:8006">https://200.129.71.165:8006</a></li>
            </ol>
        <p>Garanta que as duas VMs estão ligadas (XEN e Proxmox).</p>

        <h2 id="ip_proxmox">Obtendo IP do Proxmox</h2>

            <p>Faça o login no Proxmox e use ifconfig para obter o IP (ens18).</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Proxmox</tab>
                </tabs>
                <pre><code>
                    <comment># login</comment>
                    <t>Usuário:</t> djr 
                    <t>Senha:</t> 654123

                    <comment># obtendo IP</comment>
                    <t>></t> ifconfig
                </code></pre>
            </div>
 
        <h2 id="permissoes">Permissões</h2>

            <p>No terminal da VM Xen, rode o comando a seguir:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">XEN</tab>
                </tabs>
                <pre><code>
                    <comment># estabelecendo conexão</comment>
                    <t>></t> ssh djr@192.168.0.[IP_Proxmox]

                    <comment># abrindo o arquivo de configuração</comment>
                    <t>></t> sudo nano /etc/ssh/sshd_config
                </code></pre>
            </div>

            <p>Procure a linha <code>#PermitRootLogin prohibit-password</code> e substitua por <code>PermitRootLogin yes</code>.</p>

            <p><strong>Ctrl + O</strong> e Enter para salvar, e <strong>Ctrl + X</strong> para sair do arquivo.</p>

            <p>Agora, troque a senha:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <comment># se transformando em SuperUsuário</comment>
                    <t>Usuário:</t> sudo su 
                    <t>Senha:</t> 654123

                    <comment># trocando a senha</comment>
                    <t>></t> passwd
                    <t>></t> 654123 <comment># digite a senha</comment>
                    <t>></t> 654123 <comment># repita a senha</comment>
                </code></pre>
            </div>

            <p>Saindo do SSH:</p>
            <p></p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <t>></t> exit <comment># vai sair do sudo su</comment>
                    <t>></t> exit <comment># saindo do SSH</comment>
                </code></pre>
            </div>

        <h2 id="script">Script</h2>

            <p>Verifique a existencia da pasta "medidas". Ela deve estar no "~", então digite <code>ls</code> e caso ela exista, rode <code>UM DOS COMANDOS ABAIXO</code>:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <comment># pelo terminal</comment>
                    <t>djr@dut:~/</t> rm -rf ./medidas

                    <comment># Gerenciador de Arquivos</comment>
                    <t>/home/djr</t> medidas
                </code></pre>
            </div>
            
            <p>Precisando ou não excluri a pasta "medidas", agora temos que rodar o script:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <comment># baixando do site</comment>
                    <t>></t> curl -o ./install.sh https://talesgardem.com.br/installnodejs.sh

                    <comment># tornando o arquivo executável</comment>
                    <t>></t> chmod +x ./install.sh

                    <comment># instalando</comment>
                    <t>></t> sudo ./install.sh

                    <comment># espere baixar</comment>

                    <comment># entrando no diretório</comment>
                    <t>></t> cd medidas/build

                    <comment># executando o script</comment>
                    <t>></t> sudo nano constants.js
                </code></pre>
            </div>

            <p>Irá abrir um arquivo para você mudar os IPs necessários, no caso o IP do Proxmox. Depois, <strong>Ctrl + O</strong> e Enter para salvar e <strong>Ctrl + X</strong> para sair do arquivo.</p>

            <p>Continue com os comandos a seguir:</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <comment># instalando o nvm14</comment>
                    <t>></t> nvm install 14 

                    <comment># caso dê errado, siga o passo a seguir</comment>
                </code></pre>
            </div>

            <p>Caso seu comando anterior tenha resultado em erro, siga as instruções abaixo. Caso tenha dados certo, pode seguir em frente.</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <t>></t> cd medidas/build
                    <t>></t> nvm install 14
                </code></pre>
            </div>

            <p></p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <comment># rodando o script</comment>
                    <t>></t> sudo "$(which node)" ./auto.js
                </code></pre>
            </div>

            <p>Agora, espere até aparecer a mensagem de "Medições Finalizadas >:Dc"</p>

        <h2 id="tirando_arquivos">Tirando os Arquivos da VM</h2>

            <p>Depois do script terminar de rodar, entre no Gerenciador de Arquivos e siga o caminho <strong>/home/djr/medidas/build/atividade1</strong>. Você deve encontrar 3 pastas (apache2, nginx e nginx_quic) e um arquivo "results.csv".</p>

            <p>Selecione as 3 pastas, clique com o botão direito, depois em <strong>"Comprimir"</strong> e, na parte inferior da nova janela, escolha a opção <code>.tar.gz</code>.</p>

            <p>Abra o navegador da VM e entre no endereço <a href="https://talesgardem.com.br/chat.html">https://talesgardem.com.br/chat.html</a>, faça seu login temporário e envie seus arquivos (pasta compactada, de preferência com seu nome, e o arquivo .csv).</p>

            <p>Como práticas de boa convivência, apague a pasta <strong>medidas</strong>.</p>
            <div class="box">
                <tabs>
                    <tab class="selected">Xen</tab>
                </tabs>
                <pre><code>
                    <t>djr@djr:~$</t> rm -rf ./medidas
                </code></pre>
            </div>

        <h2 id="enviando_arquivos">Baixando e Enviando Arquivos</h2>

            <p>Entrando no navegador da sua máquina, entre no mesmo endereço do <a href="https://talesgardem.com.br/chat.html">Talesgardem</a> e baixe os arquivos que você enviou.</p>

            <p>Como é pedido o envio de uma planilha eletrônica, abra uma Planilha Google e siga os passos a seguir.</p>

            <p>Cria uma planilha nova, totalmente em braco. Vá em <strong>"Arquivo"</strong>, no menu superior e em <strong>"Importar"</strong>. Escolha a opção de <strong>"Fazer upload"</strong> e escolha o arquivo "results.csv". Por último, troque o <strong>Tipo de Separador</strong> por "Vírgula" e desmarque a caixa de seleção para a conversão automática de texto em números, datas e fórmulas.</p>
    </div>
</body>
</html>